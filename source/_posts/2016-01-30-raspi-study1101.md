title: "树莓派GPIO入门11-使用SPI接口驱动一块液晶屏幕"
date: 2016-01-30 17:03:19
categories: 树莓派
tags:
- 树莓派GPIO入门系列
- SPI
- 液晶屏
---
本文将使用SPI接口驱动一块支持spi通讯协议的液晶屏幕。控制屏幕显示文字，绘制图形或是显示图片。

<!-- more -->

###最终效果TODO
视频演示

###硬件
- 1.44英寸 spi接口 128x128液晶屏幕 X 1（淘宝10-20元）
![TODO](http://xxx)

###原理说明

####SPI简介

####启动树莓派的spi功能
spi功能默认是关闭的，使用前需要先启用。
编辑raspi-blacklist.conf文件：
```
sudo nano /etc/modprobe.d/raspi-blacklist.conf
```

注释掉下面这一行(在前面加上#号)
```
#blacklist spi-bcm2708
```

另外还需要编辑config.txt文件：
```
sudo nano /boot/config.txt
```

在最后加上下面这一行：
```
dtparam=spi=on
```

注：nano编辑器保存文件的方法是ctrl+x, 按下y，然后回车。

然后重启即可。
```
sudo reboot
```

重启后，检查spi设备是否已经启用
```
ls /dev/spi*
```
应该能看到下面2个设备，表示spi已经启用了。
```
/dev/spidev0.0  /dev/spidev0.1
```

####测试spi功能
TODO
This can be used to test SPI send and receive. Put a wire between MOSI and MISO
将MOSI和MISO引脚互联，然后下载并编译执行一个测试程序：
```
wget https://raw.githubusercontent.com/raspberrypi/linux/rpi-3.10.y/Documentation/spi/spidev_test.c
gcc -o spidev_test spidev_test.c
./spidev_test -D /dev/spidev0.0
```
应该能看到如下的输出
```
spi mode: 0
bits per word: 8
max speed: 500000 Hz (500 KHz)

FF FF FF FF FF FF
40 00 00 00 00 95
FF FF FF FF FF FF
FF FF FF FF FF FF
FF FF FF FF FF FF
DE AD BE EF BA AD
F0 0D
```
能看到spi的传输速度，这个速度是可以配置的，本文不做讨论。

####树莓派spi相关引脚
TODO

####液晶屏驱动
TODO

####连接树莓派和液晶屏
TODO

####Hello World
TODO

###代码（Python）
TODO